#summary Improve SocialConnect

== Introduction ==

SocialConnect is highly modular to allow addition of new functionalities. Support for new calls to the Facebook or OpenSocial APIs can added simply by writing two methods in the model layer and two in the proxy layer.

The method in the model layer is responsible to first check if the remote platform supports the call and then check if the call is authorized. The model layer then instantiate the correct proxy layer that will send the call to the API.

This schema is the same for each functionality with minor differences.

*Model layer:*
{{{
def send_notifications(self, request, callback, user_ids, text, *args):
	'''
	Send a notification to a list of users on the remote platform
			
	Params:
		request: the django http request
		callback: the view to callback if an RedirectException occurs
		users_ids: target for the notification
		text: text of the notification
		args: any args for the callback view
				
	'''
		
	# check if the platform supports the call		
	if not self.current_platform.support_notifications:
		raise NotSupportedException()

	# validate of the context, then call
	if self._validate_context(request, callback, args):
		return self._send_notifications(user_ids, text)		


def _send_notifications(self, user_ids, text):
	'''
	Private method that instanciate the correct Proxy and call the api
	'''
	
	if self.current_platform.__class__ == FBPlatform:
		proxy = FBRequestProxy(self.com_object)	
	else:
		proxy = OSRequestProxy(self.com_object)	
	return proxy.send_notifications(user_ids, text)

}}}

*Proxy layer:*
{{{
def send_notifications(self, uids, text, type='user_to_user'):
	'''
	This function send a notification to the ids provided
			
	Params:
		uids: target users
		text: text of the notification
		type: type is 'user_to_user' by default but 'app_to_user' is also possible
		
	'''
	return self.com_object.notifications.send(uids, text, type=type)
	
}}}

=== Activities ===
The main next improvement would be the support of activities for OpenSocial. Actually, activities can be notified only on Facebook.